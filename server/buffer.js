!function(){function e(e){this.opts=e,this.max_buffer_size=104857600,this._size=0,this.deque=[]}e.prototype={clear:function(){this.deque=[],this._size=0},flatten:function(){if(1==this.deque.length)return this.deque[0];for(var e=0,t=0;t<this.deque.length;t++)e+=this.deque[t].byteLength;var s=new Uint8Array(e),i=0;for(t=0;t<this.deque.length;t++)s.set(new Uint8Array(this.deque[t]),i),i+=this.deque[t].byteLength;return this.deque=[s.buffer],s.buffer},add:function(e){console.assert(e instanceof ArrayBuffer),this._size=this._size+e.byteLength,this.deque.push(e)},consume_any_max:function(e){return this.size()<=e?this.consume(this.size()):this.consume(e)},consume:function(e,t){if(e>this._size)return console.assert(!1),!1;for(var s,i=0,n=new Uint8Array(e);i<e;){if(s=this.deque[0],console.assert(s instanceof ArrayBuffer),!(i+s.byteLength<=e)){var r=new Uint8Array(s,0,e-i);n.set(r,i);var u=s.byteLength-(e-i),h=new Uint8Array(s,e-i,u),f=new Uint8Array(u);f.set(h,0),this.deque[0]=f.buffer;break}n.set(new Uint8Array(s),i),i+=s.byteLength,this.deque.shift()}return t?this.deque=[n.buffer].concat(this.deque):this._size-=e,n.buffer},size:function(){return this._size}},WSC.Buffer=e}();